ASSIST/UNA Version 1.0      GRADE RUN FOR: QTQ 


  LOC     OBJECT CODE    STMT   SOURCE STATEMENT 				 PAGE 1

                           1 *ANDREW AARON
                           2 *ASSIGNMENT:PROGRAM #5
                           3 *DUE: 4/17/2013
                           4 *
                           5 *DESCRIPTION:
                           6 *    THIS PROGRAM WILL MAINTAIN THE BALANCE FOR A SAVINGS ACCOUNT.
                           7 *  IT WILL ACCEPT AS INPUT UP TO A 10 DIGIT CARD, AND PERFORM
                           8 *  VARIOUS ACTIONS DEPENDING ON THE 1ST CHAR IN THE CARD.
                           9 *
                          10 *INPUT: VARIOUS CARDS, EACH EITHER 10 OR 4 DIGITS LONG.
                          11 *OUTPUT: A REPORT DETAILING THE VARIOUS ACTIONS PERFORMED
                          12 *
                          13 *
                          14 *REGISTER KEY:
                          15 *  REGISTER 1 - HOLDS A POINTER FOR INSERTING $
                          16 *  REGISTER 11 - HOLDS THE ADDRESS OF NEXT INSTRUCTION WHEN
                          17 *              CALLING SUBROUTINES.
                          18 **********************************************************************
                          19 *                            BEGINNING HK
000000                    20 PROJECT5 START
000000 90EC D00C          21          STM   14,12,12(13)
000004 05C0               22          BALR  12,0
000006                    23          USING HERE,12
000006 50D0 C092          24 HERE     ST    13,SAVEAREA+4
00000A 41D0 C08E          25          LA    13,SAVEAREA

                          27 **********************************************************************
                          28 *                                BODY

00000E E020 C16E 0024     30          XPRNT HEADER1,36
000014 E020 C192 0030     31          XPRNT HEADER2,48

00001A E000 C0D6 000A     33 MAINLOOP XREAD CARD,10              READ A LINE OF INPUT
000020 4740 C05C          34          BC    B'0100',ENDLOOP      IF EOF, END LOOP
000024 45B0 C3F8          35          BAL   11,CLEARPAT          CLEAR THE OUTPUT VARIABLE PATTERNS
000028 95F3 C0D6          36          CLI   CARD,C'3'            SEE IF A RATE WAS ENTERED
00002C 4770 C032          37          BC    B'0111',TRYNEXT      IF NOT, TRY SOMETHING ELSE
000030 45B0 C39C          38          BAL   11,SUBRATE           IF SO, GO TO RATE SUBROUTINE
000034 47F0 C052          39          BC    B'1111',ACTNDONE
000038 95F1 C0D6          40 TRYNEXT  CLI   CARD,C'1'            IF NOT RATE, CHECK FOR OTHERS
00003C 4740 C046          41          BC    B'0100',ISINITL      IF NOT 3 AND < 1, ITS 0
000040 4720 C04E          42          BC    B'0010',ISWITHD      IF NOT 3 AND > 1, ITS 2
000044 45B0 C320          43          BAL   11,SUBDEPOS          OTHERWISE, ITS 1, SO DEPOSIT
000048 47F0 C052          44          BC    B'1111',ACTNDONE
00004C 45B0 C2C0          45 ISINITL  BAL   11,SUBINITL          IF 0, INITIALIZE THE BALANCE
000050 47F0 C052          46          BC    B'1111',ACTNDONE
000054 45B0 C356          47 ISWITHD  BAL   11,SUBWITHD          IF 2, WITHDRAW FROM BALANCE
000058 E020 C110 002E     48 ACTNDONE XPRNT CC,46                WHEN WE ARE DONE, PRINT RESULTS
00005E 47F0 C014          49          BC    B'1111',MAINLOOP     AND RESTART LOOP

000062 E020 C110 0001     51 ENDLOOP  XPRNT CC,1
000068 45B0 C418          52          BAL   11,DEPSUMRY            AFTER LOOP ENDS, DO SUMMARIES
00006C 45B0 C494          53          BAL   11,WITSUMRY
000070 D20F C2AF C151     54          MVC   FINALBAL(16),PATTERN1  SET OUTPUT FOR FINAL BALANCE
000076 DF0F C2AF C0E9     55          EDMK  FINALBAL(16),BALANCE   PASS IN LAST CURRENT BALANCE
00007C 0610               56          BCTR  1,0                    AND ADD THE $
00007E 925B 1000          57          MVI   0(1),C'$'
000082 E020 C29D 0022     58          XPRNT HEADER3,34             FINALLY, SHOW THE FINAL BALANCE

                          60 **********************************************************************
                          61 *                               END HK
000088 58D0 C092          62          L     13,SAVEAREA+4
00008C 98EC D00C          63          LM    14,12,12(13)
000090 07FE               64          BR    14
000094                    65 SAVEAREA DS    18F
                          66 **********************************************************************
                          67 *                              VARIABLES

0000DC                    69 CARD     DS    ZL10           INPUT LINE
0000E6                    70 AMOUNT   DS    PL6            HOLDS CURRENT AMOUNT
0000EC                    71 RATE     DS    PL3            HOLDS CURRENT RATE
0000EF                    72 BALANCE  DS    PL6            HOLDS CURRENT BALANCE
0000F5                    73 MINBAL   DS    PL6            FOR KEEPING UP WITH MIN BALANCE
0000FB                    74 TOTLWITD DS    PL6            HOLDS THE TOTAL AMOUNT WITHDRAWN
000101                    75 TOTLDEPO DS    PL6            HOLDS THE TOTAL AMOUNT DEPOSITED
000107                    76 WITCOUNT DS    PL3            HOLDS THE NUM OF WITHDRAWALS
00010A                    77 DEPCOUNT DS    PL3            HOLDS THE NUM OF DEPOSITS
                          78 *
                          79 *FORDIV IS USED FOR CALCULATING INTEREST, AND AVG DEPOSIT/WITHDRAW
00010D                    80 FORDIV   DS    0PL9           ENTIRE DIVIDED SPACE
00010D                    81 QUOTIENT DS    PL6            QUOTIENT SPACE,INTEREST IS HERE
000113                    82 REMAIN   DS    PL3            REMAINDER SPACE, FOR ROUNDING
                          83 *
000116 F0                 84 CC       DC    C'0'           FOR CARRIAGE CONTROL
000117 40404040           85          DC    C'    '        OUTPUT SPACING
00011B                    86 CODE     DS    CL1            OUTPUT LINE FOR CODE
00011C                    87 AMOUNTP  DS    XL16           AMOUNT PATTERN OUTPUT LINE
00012C 40                 88          DC    C' '
00012D                    89 RATEP    DS    XL7            RATE PATTERN OUTPUT LINE
000134                    90 BALANCEP DS    XL16           BALANCE PATTERN OUTPUT LINE
                          91 *
000144 F0                 92 ZERO     DC    X'F0'
000145 0C                 93 PZERO    DC    P'0'           FOR CLEARING, AND DENOM COMPARE
000146 F1                 94 ONE      DC    X'F1'          TO BE PACKED INTO PONE
000147                    95 PONE     DS    PL1            FOR ROUNDING UP INTEREST
000148 F1F0F0F0F0         96 TNTHSND  DC    X'F1F0F0F0F0'  FOR DIVIDING INTEREST
00014D                    97 PTNTHSND DS    PL3
000150 F5F0F0F0           98 FIVETHS  DC    X'F5F0F0F0'    FOR COMPARING WHEN ROUNDING
000154                    99 PFIVETHS DS    PL3
000157 402020206B202020  100 PATTERN1 DC    X'402020206B2020206B2021204B202060' MONEY PATTERN
000167 402021204B2020    101 PATTERN2 DC    X'402021204B2020'                   RATE PATTERN
00016E 402020202120      102 PATTERN3 DC    X'402020202120'                     COUNT PATTERN

000174 F140404040404040  104 HEADER1  DC    C'1         SAVINGS   ACCOUNT   REPORT'
000198 F0E3D9C1D54B40C3  105 HEADER2  DC    C'0TRAN. CODE    AMOUNT    RATE    CURRENT BALANCE'

0001C8 F07B40C4C5D7D6E2  107 DEPHEAD1 DC    C'0# DEPOSITS ='
0001D5                   108 NUMDEPOS DS    XL6            OUTPUT FOR DEPOSIT COUNTER

0001DB F0E3D6E3C1D340C1  110 DEPHEAD2 DC    C'0TOTAL AMOUNT OF DEPOSITS ='
0001F6                   111 TOTDEPOP DS    XL16           OUTPUT FOR DEPOSIT ACCUMULATOR

000206 F0C1E5C74B40C1D4  113 DEPHEAD3 DC    C'0AVG. AMOUNT/DEPOSIT      ='
000221                   114 AVGDEPOP DS    XL16           OUTPUT FOR AVG DEPOSIT

000231 F07B40E6C9E3C8C4  116 WITHEAD1 DC    C'0# WITHDRAWALS ='
000241                   117 NUMWITHD DS    XL6            OUTPUT FOR WITHDRAW COUNTER

000247 F0E3D6E3C1D340C1  119 WITHEAD2 DC    C'0TOTAL AMOUNT OF WITHDRAWALS ='
000265                   120 TOTWITDP DS    XL16           OUTPUT FOR WITHDRAW ACCUMULATOR

000275 F0C1E5C74B40C1D4  122 WITHEAD3 DC    C'0AVG. AMOUNT/WITHDRAWAL      ='
000293                   123 AVGWITDP DS    XL16           OUTPUT FOR AVG DEPOSIT

0002A3 F0C3E4D9D9C5D5E3  125 HEADER3  DC    C'0CURRENT BALANCE ='
0002B5                   126 FINALBAL DS    XL16           OUTPUT FOR BALANCE AT THE END

                         128 **********************************************************************
                         129 *                             SUBROUTINES
                         130 *
                         131 ***
                         132 *  SUBINITL WILL TAKE THE INPUT AND USE IT TO INITIALIZE THE BALANCE.
                         133 *  IT WILL ALSO SET THE MIN BALANCE, AND CLEAR THE ACCUMULATORS.
                         134 *

0002C6 92F0 C115         136 SUBINITL MVI   CODE,C'0'                SET CODE OUTPUT
0002CA F258 C0E0 C0D7    137          PACK  AMOUNT(6),CARD+1(9)      GET AMOUNT FROM CARD
0002D0 F200 C13F C13E    138          PACK  PZERO(1),ZERO(1)
0002D6 F200 C141 C140    139          PACK  PONE(1),ONE(1)           SET UP PACKED VARIABLES
0002DC F224 C147 C142    140          PACK  PTNTHSND(3),TNTHSND(5)
0002E2 F223 C14E C14A    141          PACK  PFIVETHS(3),FIVETHS(4)
0002E8 F855 C0E9 C0E0    142          ZAP   BALANCE(6),AMOUNT(6)     SET THE BALANCE TO AMOUNT
0002EE F855 C0EF C0E0    143          ZAP   MINBAL(6),AMOUNT(6)      ALSO SET THE MIN BALANCE
0002F4 F820 C104 C13F    144          ZAP   DEPCOUNT(3),PZERO(1)     CLEAR THE COUNTERS
0002FA F820 C101 C13F    145          ZAP   WITCOUNT(3),PZERO(1)
000300 F850 C0F5 C13F    146          ZAP   TOTLWITD(6),PZERO(1)     ALSO CLEAR ACCUMULATORS
000306 F850 C0FB C13F    147          ZAP   TOTLDEPO(6),PZERO(1)
00030C D20F C116 C151    148          MVC   AMOUNTP(16),PATTERN1     SET THE PATTERNS FOR OUTPUT
000312 D20F C12E C151    149          MVC   BALANCEP(16),PATTERN1
000318 DE0F C116 C0E0    150          ED    AMOUNTP(16),AMOUNT       SET THE OUTPUT FROM PATTERNS
00031E DE0F C12E C0E9    151          ED    BALANCEP(16),BALANCE
000324 07FB              152          BR    11

                         154 *
                         155 *  SUBDEPOS WILL TAKE THE INPUT AND DEPOSIT IT INTO THE BALANCE.
                         156 *

000326 92F1 C115         158 SUBDEPOS MVI   CODE,C'1'               SET CODE OUTPUT
00032A F258 C0E0 C0D7    159          PACK  AMOUNT(6),CARD+1(9)     GET AMOUNT FROM CARD
000330 FA55 C0E9 C0E0    160          AP    BALANCE(6),AMOUNT(6)    UPDATE THE BALANCE USING AMOUNT
000336 FA55 C0FB C0E0    161          AP    TOTLDEPO(6),AMOUNT(6)   UPDATE DEPOSIT ACCUMULATOR
00033C D20F C116 C151    162          MVC   AMOUNTP(16),PATTERN1
000342 D20F C12E C151    163          MVC   BALANCEP(16),PATTERN1   SET PATTERNS FOR OUTPUT
000348 DE0F C116 C0E0    164          ED    AMOUNTP(16),AMOUNT
00034E DE0F C12E C0E9    165          ED    BALANCEP(16),BALANCE    SET OUPUT FROM PATTERNS
000354 FA20 C104 C141    166          AP    DEPCOUNT(3),PONE(1)     UPDATE DEPOSIT COUNTER
00035A 07FB              167          BR    11

                         169 *
                         170 *  SUBWITHD WILL TAKE THE INPUT AND WITHDRAW IT FROM THE BALANCE.
                         171 *

00035C 92F2 C115         173 SUBWITHD MVI   CODE,C'2'               SET CODE OUTPUT
000360 F258 C0E0 C0D7    174          PACK  AMOUNT(6),CARD+1(9)     GET AMOUNT FROM CARD
000366 FB55 C0E9 C0E0    175          SP    BALANCE(6),AMOUNT(6)    UPDATE BALANCE
00036C FA55 C0F5 C0E0    176          AP    TOTLWITD(6),AMOUNT(6)   UPDATE WITHDRAW ACCUMULATOR
000372 F955 C0EF C0E9    177          CP    MINBAL(6),BALANCE(6)    SEE IF MINBAL NEEDS UPDATE
000378 4740 C37C         178          BC    B'0100',NONEWMIN
00037C F855 C0EF C0E9    179          ZAP   MINBAL(6),BALANCE(6)    IF SO, UPDATE IT
000382 D20F C116 C151    180 NONEWMIN MVC   AMOUNTP(16),PATTERN1
000388 D20F C12E C151    181          MVC   BALANCEP(16),PATTERN1   SET PATTERNS FOR OUTPUT
00038E DE0F C116 C0E0    182          ED    AMOUNTP(16),AMOUNT
000394 DE0F C12E C0E9    183          ED    BALANCEP(16),BALANCE    SET OUTPUT FROM PATTERNS
00039A FA20 C101 C141    184          AP    WITCOUNT(3),PONE(1)     UPDATE WITHDRAW COUNTER
0003A0 07FB              185          BR    11

                         187 *
                         188 *  SUBRATE WILL CALCULATE INTEREST BASED OFF THE GIVEN RATE.
                         189 *  IT WILL ADD THE INTEREST TO THE BALANCE, AND UPDATE MINBAL.
                         190 *

0003A2 92F3 C115         192 SUBRATE  MVI   CODE,C'3'                 SET CODE OUTPUT
0003A6 F222 C0E6 C0D7    193          PACK  RATE(3),CARD+1(3)         GET RATE FROM CARD
0003AC F885 C107 C0EF    194          ZAP   FORDIV(9),MINBAL(6)       MINBAL IS STARTING POINT
0003B2 FC82 C107 C0E6    195          MP    FORDIV(9),RATE(3)         RATE * MINBAL = INTEREST
0003B8 FD82 C107 C147    196          DP    FORDIV(9),PTNTHSND(3)     CUT OFF 4 OF THE 6 DECIMALS
0003BE F922 C10D C14E    197          CP    REMAIN(3),PFIVETHS(3)     CHECK TO SEE IF IT ROUNDS
0003C4 4740 C3C8         198          BC    B'0100',NOROUND
0003C8 FA50 C107 C141    199          AP    QUOTIENT(6),PONE(1)       IF SO, ADD ONE
0003CE F950 C107 C13F    200 NOROUND  CP    QUOTIENT(6),PZERO(1)      CHECK TO SEE IF NEG INTEREST
0003D4 4740 C3D8         201          BC    B'0100',DONTADD           IF SO, DONT ADD INTEREST
0003D8 FA55 C0E9 C107    202          AP    BALANCE(6),QUOTIENT(6)    ADD INTEREST
0003DE F855 C0EF C0E9    203 DONTADD  ZAP   MINBAL(6),BALANCE(6)      SET NEW MINBAL
0003E4 D206 C127 C161    204          MVC   RATEP(7),PATTERN2
0003EA D20F C12E C151    205          MVC   BALANCEP(16),PATTERN1     SET PATTERNS FOR OUTPUT
0003F0 DE0F C12E C0E9    206          ED    BALANCEP(16),BALANCE      SET OUTPUT FROM PATTERNS
0003F6 DE06 C127 C0E6    207          ED    RATEP(7),RATE
0003FC 07FB              208          BR    11

                         210 *
                         211 *  CLEARPAT WILL CLEAR THE PATTERNS IN THE OUTPUT LINES
                         212 *

0003FE 9240 C116         214 CLEARPAT MVI   AMOUNTP,C' '
000402 D20E C117 C116    215          MVC   AMOUNTP+1(15),AMOUNTP
000408 9240 C127         216          MVI   RATEP,C' '
00040C D205 C128 C127    217          MVC   RATEP+1(6),RATEP
000412 9240 C12E         218          MVI   BALANCEP,C' '
000416 D20E C12F C12E    219          MVC   BALANCEP+1(15),BALANCEP
00041C 07FB              220          BR    11

                         222 *
                         223 *  DEPSUMRY WILL CALCULATE AND PRINT THE DEPOSIT SUMMARY
                         224 *

00041E D205 C1CF C168    226 DEPSUMRY MVC   NUMDEPOS(6),PATTERN3      SET PATTERNS FOR COUNTER
000424 DE05 C1CF C104    227          ED    NUMDEPOS(6),DEPCOUNT
00042A E020 C1C2 0013    228          XPRNT DEPHEAD1,19               OUTPUT COUNTER
000430 F920 C104 C13F    229          CP    DEPCOUNT(3),PZERO(1)      MAKE SURE COUNTER ISNT 0
000436 4720 C43A         230          BC    B'0010',NONZERO
00043A F820 C104 C141    231          ZAP   DEPCOUNT(3),PONE(1)       IF IT IS, MAKE IT ONE
000440 D20F C1F0 C151    232 NONZERO  MVC   TOTDEPOP(16),PATTERN1     SET PATTERNS FOR TOTAL
000446 DF0F C1F0 C0FB    233          EDMK  TOTDEPOP(16),TOTLDEPO
00044C 0610              234          BCTR  1,0                       SET POINTER FOR $
00044E 925B 1000         235          MVI   0(1),C'$'                 AND INSERT THE $
000452 E020 C1D5 002B    236          XPRNT DEPHEAD2,43               OUTPUT THE TOTAL
000458 F885 C107 C0FB    237          ZAP   FORDIV(9),TOTLDEPO
00045E FD82 C107 C104    238          DP    FORDIV(9),DEPCOUNT        FIND AVG DEPOSIT
000464 FA22 C10D C10D    239          AP    REMAIN(3),REMAIN(3)       SEE IF IT SHOULD ROUND
00046A F922 C10D C104    240          CP    REMAIN(3),DEPCOUNT(3)
000470 4740 C474         241          BC    B'0100',NOROUND2
000474 FA50 C107 C141    242          AP    QUOTIENT(6),PONE(1)       IF SO, ROUND THE AVG
00047A D20F C21B C151    243 NOROUND2 MVC   AVGDEPOP(16),PATTERN1     SET PATTERNS FOR AVG
000480 DF0F C21B C107    244          EDMK  AVGDEPOP(16),QUOTIENT     SET POINTER FOR $
000486 0610              245          BCTR  1,0
000488 925B 1000         246          MVI   0(1),C'$'
00048C E020 C200 002B    247          XPRNT DEPHEAD3,43               OUTPUT THE AVG
000492 E020 C110 0001    248          XPRNT CC,1
000498 07FB              249          BR    11

                         251 *
                         252 *  WITSUMRY WILL CALCULATE AND PRINT THE WITHDRAW SUMMARY
                         253 *

00049A D205 C23B C168    255 WITSUMRY MVC   NUMWITHD(6),PATTERN3      DO THE SAME AS DEPOSIT
0004A0 DE05 C23B C101    256          ED    NUMWITHD(6),WITCOUNT
0004A6 E020 C22B 0016    257          XPRNT WITHEAD1,22
0004AC F920 C101 C13F    258          CP    WITCOUNT(3),PZERO(1)
0004B2 4720 C4B6         259          BC    B'0010',NONZERO2
0004B6 F820 C101 C141    260          ZAP   WITCOUNT(3),PONE(1)
0004BC D20F C25F C151    261 NONZERO2 MVC   TOTWITDP(16),PATTERN1
0004C2 DF0F C25F C0F5    262          EDMK  TOTWITDP(16),TOTLWITD
0004C8 0610              263          BCTR  1,0
0004CA 925B 1000         264          MVI   0(1),C'$'
0004CE E020 C241 002E    265          XPRNT WITHEAD2,46
0004D4 F885 C107 C0F5    266          ZAP   FORDIV(9),TOTLWITD
0004DA FD82 C107 C101    267          DP    FORDIV(9),WITCOUNT
0004E0 FA22 C10D C10D    268          AP    REMAIN(3),REMAIN(3)
0004E6 F922 C10D C101    269          CP    REMAIN(3),WITCOUNT(3)
0004EC 4740 C4F0         270          BC    B'0100',NOROUND3
0004F0 FA50 C107 C141    271          AP    QUOTIENT(6),PONE(1)
0004F6 D20F C28D C151    272 NOROUND3 MVC   AVGWITDP(16),PATTERN1
0004FC DF0F C28D C107    273          EDMK  AVGWITDP(16),QUOTIENT
000502 0610              274          BCTR  1,0
000504 925B 1000         275          MVI   0(1),C'$'
000508 E020 C26F 002E    276          XPRNT WITHEAD3,46
00050E E020 C110 0001    277          XPRNT CC,1
000514 07FB              278          BR    11

                         280 *
                         281 **********************************************************************
                         282 *                            END OF PROGRAM
                         283          END   PROJECT5


*** 0 STATEMENTS FLAGGED - 0 ERRORS FOUND


*** PROGRAM EXECUTION BEGINNING -
ANY OUTPUT BEFORE EXECUTION COMPLETE MESSAGE IS PRODUCED BY USER PROGRAM ***


         SAVINGS   ACCOUNT   REPORT

TRAN. CODE    AMOUNT    RATE    CURRENT BALANCE

    0         212.14                  212.14 

    1         110.00                  322.14 

    2          42.00                  280.14 

    3                    4.00         288.63 

    3                    5.50         304.50 

    1         252.36                  556.86 

    2           3.50                  553.36 

    2          10.00                  543.36 

    1          20.00                  563.36 

    3                    2.55         571.12 

    1          30.00                  601.12 

    3                    9.00         652.52 

    1       5,000.00                5,652.52 

    2         341.35                5,311.17 

    3                    0.99       5,317.63 

    1          10.00                5,327.63 



# DEPOSITS =     6

TOTAL AMOUNT OF DEPOSITS =      $5,422.36 

AVG. AMOUNT/DEPOSIT      =        $903.73 



# WITHDRAWALS =     4

TOTAL AMOUNT OF WITHDRAWALS =        $396.85 

AVG. AMOUNT/WITHDRAWAL      =         $99.21 



CURRENT BALANCE =      $5,327.63 

*** EXECUTION COMPLETED ***